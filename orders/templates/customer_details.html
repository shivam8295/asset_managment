{% load static%}

{% include 'base_dashboard.html' %}
{% block content %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.2/min/dropzone.min.css">

<!-- Include FontAwesome CSS (you can change the version if needed) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.9.2/min/dropzone.min.js"></script>

<style>
    h2 {
        text-align: center;
    }
    

    /* Optional: Add custom styling to the Dropzone container */
  

    /* Optional: Add styling for the icon */
    .upload-icon {
        font-size: 40px;
        color: #0087F7;
        margin-bottom: -90px;
        margin-top: 15px;
    }

/* 
    .navbar-second {
        width: 100%;
        background-color: #fff;
        overflow: auto;
        padding-left: 2%;
        border-bottom: 2px solid #CCCCCC;
        padding-bottom: -5px;
    } */

   

    

    .avaibtn select {
        color: #007E33;
        background-color: #CCF4DC;
        box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.16);
        border: 1px solid #CCCCCC;
        border-radius: 5px;
        height: 35px;
    }


    .tab {
  overflow: hidden;
  border: 1px solid #ccc;
  padding: 0 30px;
  /* background-color: #f1f1f1; */
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  border: none;
}

/* Create an active/current tablink class */
.tab button.active {
  border-bottom:2px solid #6A1B9A;
  color: #6A1B9A;
}

/* Style the tab content */
.tabcontent {
  display: none;
  border: 1px solid #ccc;
  border-top: none;
}

/* Set initial display for the first tab content */
#London {
  display: block;
}
button.tablinks {
        float: left;
        padding: 12px;
        color: #7C7C7C;
        text-decoration: none;
        font-size: 15px;
        font-weight: 600;
        text-transform: uppercase;
        display: flex;
        align-items: center;
        
    }
    button.tablinks svg {
        margin-right: 5px;
    }
    table {
            width: 100%;
            border-collapse: separate; /* Set border-collapse to separate */
            border-spacing: 0; /* Remove the space between cells */
            margin-top: 20px;
            border: 1px solid #F7EDFD;
            border-radius:10px ;

        }

        th, td {
            border: 1px solid #F7EDFD;
            padding: 8px;
            text-align: left;
        
        }
        .table thead th {
            border: none;
             color: #4C555D;
             font-size: 15px;
             font-weight: 600;
        }

        th {
            background-color: #F7EDFD;
            text-transform: uppercase;
            color: #4C555D;
            border: none; /* Remove border for th */
        }
        td {
            text-transform: capitalize;
            font-size: 14px;
        }

        /* Style for checkboxes */
        .checkbox-column {
            text-align: center;
        }
        th, td {
            border: none;
        }
        .assebutton{
            display: flex;
            gap: 10px;
        }
        td.tbname {
            color: #006FC8;
            text-transform:uppercase;
            text-decoration: none;
        }
        td.tbname a {
            text-decoration: none;
        }

        .pagination{
            float:right;
        }
    

        .spinner-border{
            height: 20px;
            width: 20px;
    
        }
        
       
    
</style>
<section class="assetdetail">
    <button onclick="goToConfirmOrdersList()" style="border: none; margin-bottom: 10px; background-color: transparent;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="fill: #6A1B9A;transform: msFilter"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm5 11h-5v4l-5-5 5-5v4h5v2z"></path></svg></button>
    <div class="assetheaderbuttones">
        
        <div class="uploadboxy">
            <form action="/upload" class="dropzone" id="imageUpload" enctype="multipart/form-data">
                {% comment %} <div class="upload-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
                        <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"/>
                      </svg>
                </div> {% endcomment %}

            </form>
            <div class="uploadsubbtn">
                <p></p>
                {% for m in customer_obj%}
                <h1>{{m.customer}}</h1>
                <div class="editbtn">
                    <div class="editicon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                            fill="currentColor" class="bi bi-pencil-fill" viewBox="0 0 16 16">
                            <path
                                d="M12.854.146a.5.5 0 0 0-.707 0L10.5 1.793 14.207 5.5l1.647-1.646a.5.5 0 0 0 0-.708l-3-3zm.646 6.061L9.793 2.5 3.293 9H3.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.207l6.5-6.5zm-7.468 7.468A.5.5 0 0 1 6 13.5V13h-.5a.5.5 0 0 1-.5-.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.5-.5V10h-.5a.499.499 0 0 1-.175-.032l-.179.178a.5.5 0 0 0-.11.168l-2 5a.5.5 0 0 0 .65.65l5-2a.5.5 0 0 0 .168-.11l.178-.178z" />
                        </svg><a href="/asset_management/customer-form-edit/{{m.id}}/">Edit</a></div>
                </div>
                {% endfor%}

            </div>
        </div>
        {% for m in customer_obj%}
        <div class="assebutton" style="gap: 20px; display: flex;">
            {% comment %} <button>New order</button> {% endcomment %}
            <button onclick="generate_order_pdf({{m.id}})">print label</button>
        </div>
        {% endfor %}

    </div>
</section>

 <div class="navbar-navi tab">
    <button class="tablinks active" onclick="openCity(event, 'London')"><svg
        xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-card-list"
        viewBox="0 0 16 16">
        <path
            d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
        <path
            d="M5 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 5 8zm0-2.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm0 5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-1-5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zM4 8a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm0 2.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z" />
    </svg>Details</button>
    <button class="tablinks" onclick="openCity(event, 'Paris')"><svg xmlns="http://www.w3.org/2000/svg"
        width="16" height="16" fill="currentColor" class="bi bi-card-text" viewBox="0 0 16 16">
        <path
            d="M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z" />
        <path
            d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z" />
    </svg>Orders</button>
    {% comment %} <button class="tablinks" onclick="openCity(event, 'Tokyo')"> <svg xmlns="http://www.w3.org/2000/svg"
        width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
        <path
            d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z" />
        <path
            d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z" />
    </svg>Address book</button> {% endcomment %}
  </div>
  
  <div id="London" class="tabcontent">
    <section  class="assetdetail-detail " >
        {% for m in customer_obj%}
        <div class="assetdetail-containing">
           
            <div class="assetdetail-contain mt-0">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="#6A1B9A"
                        class="bi bi-file-earmark-bar-graph" viewBox="0 0 16 16">
                        <path
                            d="M10 13.5a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-6a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v6zm-2.5.5a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-1zm-3 0a.5.5 0 0 1-.5-.5v-2a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-1z" />
                        <path
                            d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z" />
                    </svg>Customer Information</h1>
                <div class="detialasset mt-4">
                    <div class="detialasset-name">
                        <p>Customer</p>
                        <div class="bndname">
                            <span class="bdnme">
                        
                                {% if m.customer == none or m.customer == "" %}
                                --
                                {% else %}
                                    {{m.customer}}
                                {% endif %}
                            </span>
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Completed Orders</p>
                        <div class="bndname">
                            {% if m.completed_orders == none or m.completed_orders == "" %}
                            --
                            {% else %}
                                {{m.completed_orders}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Deployed Orders</p>
                        <div class="bndname">
                            {% if m.deployed_order == none or m.deployed_order == "" %}
                            --
                            {% else %}
                                {{m.deployed_order}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Taxed </p>
                        <div class="bndname">
                            {% if m.taxed == none or m.taxed == "" %}
                            --
                            {% else %}
                                {{m.taxed}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Email Address </p>
                        <div class="bndname2">
                            {% if m.email_address == none or m.email_address == "" %}
                            --
                            {% else %}
                                {{m.email_address}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Department </p>
                        <div class="bndname">
                            {% if m.department == none or m.department == "" %}
                            --
                            {% else %}
                                {{m.department}}
                            {% endif %}
                        </div>
    
                    </div>
    
                    <div class="detialasset-name">
                        <p>Phone Number </p>
                        <div class="bndname">
                            {% if m.phone_number == none or m.phone_number == "" %}
                            --
                            {% else %}
                                {{m.phone_number}}
                            {% endif %}
                         </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Customer Revenue </p>
                        <div class="bndname">
                            {% if m.customer_revenue == none or m.customer_revenue == "" %}
                            --
                            {% else %}
                                {{m.customer_revenue}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Commercial Address</p>
                        <div class="bndname">
                            {% if m.commercial_address == none or m.commercial_address == "" %}
                            --
                            {% else %}
                                {{m.commercial_address}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Category </p>
                        <div class="bndname">
                            {% if m.category == none or m.category == "" %}
                            --
                            {% else %}
                                {{m.category}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Created At</p>
                        <div class="bndname">
                            {% if m.created_at == none or m.created_at == "" %}
                            --
                            {% else %}
                            {{m.created_at|date:'d-m-Y'}}
                            {% endif %}
                        </div>
    
                    </div>
                    <div class="detialasset-name">
                        <p>Secondary Email </p>
                        <div class="bndname2">
                            {% if m.secondary_email == none or m.secondary_email == "" %}
                            --
                            {% else %}
                            {{m.secondary_email}}
                            {% endif %}
                        </div>
    
                    </div>
    
                </div>
                <div class="detialasset-name" style="width: 98%;margin: 0 auto;gap: 55px;">
                    <p style="width: 500px;">Description</p>
                    <div class="bndname" style="width: 100%;">
                        {% if m.description == none or m.description == "" %}
                        --
                        {% else %}
                        {{m.description}}
                        {% endif %}
                    </div>
    
                </div>
    
            </div>
        </div>
        {% endfor%}
        <div class="leftfile">
            <div class="assetdetail-containing mt-3">
                <div class="filebtny">
                    <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            style="fill: #6A1B9A;transform: msFilter">
                            <path
                                d="M19.903 8.586a.997.997 0 0 0-.196-.293l-6-6a.997.997 0 0 0-.293-.196c-.03-.014-.062-.022-.094-.033a.991.991 0 0 0-.259-.051C13.04 2.011 13.021 2 13 2H6c-1.103 0-2 .897-2 2v16c0 1.103.897 2 2 2h12c1.103 0 2-.897 2-2V9c0-.021-.011-.04-.013-.062a.952.952 0 0 0-.051-.259c-.01-.032-.019-.063-.033-.093zM16.586 8H14V5.414L16.586 8zM6 20V4h6v5a1 1 0 0 0 1 1h5l.002 10H6z">
                            </path>
                            <path d="M8 12h8v2H8zm0 4h8v2H8zm0-8h2v2H8z"></path>
                        </svg>Files</h1>    
                        {% for m in customer_obj%}
                            <button id="uploadButton" onclick="document.getElementById('attachfile').click()">+ Attach file</button>
                            <input type="file" id="attachfile" onchange="uploadFile({{m.id}})" style="display: none;">
                       {% endfor %}
                </div>
                <div class="navbar-navi">

                    <div class="navbar-second" id="navbar2" style="padding: 0; border: none;">
                        <a id="ASSET DOCUMENTS" class="active" > ASSET
                            DOCUMENTS</a>
                        <!-- <a  id="GROUP DOCUMENTS"  onclick="setActive('navbar2','GROUP DOCUMENTS')">GROUP DOCUMENTS</a>   -->
    
                    </div>
                </div>
                <div class="filint" id="attachFile">
                    {% for m in attached_files %}               
                        {% if m.attached_file  %}
                        <div class="commrntline">
                            <li >{{m.attached_file}}</li>
                            <div>
                           <a href="{{m.attached_file.url}}" download><li ></li>Download</a>    
                           <button id="deletefile" style="background: transparent; border: none; color: red;" onclick="delete_attached_file({{m.id}})">Delete</button>
                        </div>       
                    </div>       
                        {% else %}
                        <svg xmlns="http://www.w3.org/2000/svg" width="70" height="70" fill="#A1A1A1" class="bi bi-slash-circle"
                            viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                            <path d="M11.354 4.646a.5.5 0 0 0-.708 0l-6 6a.5.5 0 0 0 .708.708l6-6a.5.5 0 0 0 0-.708z" />
                        </svg>
                        <p>No File Found</p>
                        {%endif%}
                    {% endfor %}
    
                </div>
    
    
            </div>
            <div class="assetdetail-containing mt-3">
                <div class="filebtny">
                    <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            style="fill: #6A1B9A;transform: msFilter">
                            <path
                                d="M4 18h2v4.081L11.101 18H16c1.103 0 2-.897 2-2V8c0-1.103-.897-2-2-2H4c-1.103 0-2 .897-2 2v8c0 1.103.897 2 2 2z">
                            </path>
                            <path
                                d="M20 2H8c-1.103 0-2 .897-2 2h12c1.103 0 2 .897 2 2v8c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2z">
                            </path>
                        </svg>Comments
    
                    </h1>
    
    
                </div>
                <div class="filint">
                    {% for m in comments%}
                    
                        <div class="commrntline">
                            <li style="width:60%;">{{m.comment}}</li>
                            <li >{{m.date_time}}</li>
                            
                        </div>                    
                    {%endfor%}
                </div>
        
                    {% for m in customer_obj %}
                        <div class="addcmtbtn">
                            <textarea name="comment" id="commentText" cols="30" rows="10" style="height: 40px; background-color: #fff; border-radius: 5px; border: none; padding: 5px; width: 70%; border: 1px solid #CCCCCC;
                        "></textarea>
                            <button onclick="update_comment_again({{m.id}})" value="">Add comment</button>
                        </div>
                    {% endfor %}
    
            </div>
        </div>
        
    </section>
    
        </div>
  
  <div id="Paris" class="tabcontent">
    <section  class="assetdetail-detail " >

        <div class="assetdetail-containing">
           
            <div class="assetdetail-contain mt-0">
                <h1><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="#6A1B9A" class="bi bi-journal" viewBox="0 0 16 16">
                    <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"/>
                    <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"/>
                  </svg>Order Details</h1>
                <div class="order-navisection mt-4">
                    {% for m in customer_obj%}
                    <div class=" naviorder-sec">
                        <button style="    background: #6A1B9A;
                        border: none;
                        color: #fff;
                        padding: 10px 20px;
                        font-size: 14px;
                        border: none;
                        border-radius: 5px;
                        text-transform: uppercase;"
                        onclick="generate_order_pdf({{m.id}})">Print consolidated statement</button>
                    </div>
                    {%endfor%}
                <section class="assest-container-table p-0" >
                    <table class="table">
                        <thead>
                            <tr>
                                <th class="checkbox-column" style="border-radius: 10px 0 0 0;"><input type="checkbox" id="masterCheckbox" onclick="selectAllCheckboxes(this)"></th>
                                <th>Order #</th>
                                <th>Customer </th>
                                <th>Price</th>
                                <th>Deployment Date</th>
                                <th>Return Date</th>
                                <th>Order Status</th>
                                <th>Dispatch Status</th>
                                <!-- <th style="border-radius: 0 10px  0 0; cursor: pointer;"><img src="{% static 'images/sliders.svg' %}" alt=""></th> -->
                            </tr>
                        </thead>
                        <tbody>
                            {% for m in customer_orders%}
                            <tr>
                                <td class="checkbox-column"><input type="checkbox"></td>
                                <td class="tbname"><a href="/asset_management/orders-info/{{m.orderdetail__id}}/">{{m.orderdetail__id}}</a></td>
                                <td class="tbname tablinks" onclick="openCity(event, 'London')"><a  href="#">{{m.customer}}</a></td>
                                <td>
                                    {% if m.orderdetail__price == none or m.orderdetail__price == "" %}
                                    --
                                    {% else %}
                                    {{m.orderdetail__price}}
                                    {% endif %}
                                </td>
                                <td >
                                    {% if m.orderdetail__price == none or m.orderdetail__price == "" %}
                                    --
                                    {% else %}
                                    {{m.orderdetail__deployment_date|date:'d-m-Y'}}
                                    {% endif %}
                                </td>
                                <td>{{m.orderdetail__return_date|date:'d-m-Y'}}</td>
                                <td> <div id="orderStatus{{m.orderdetail__id}}" class="book-status">
                                    {% if m.orderdetail__order_status == 2 %}
                                    Approved
                                    {% elif m.orderdetail__order_status == 3 %}
                                    Cancelled
                                    {% elif m.orderdetail__order_status == 4 %}
                                    Approved
                                    {% else%}
                                    Booked
                                    {%endif%}
                                </div> </td>              
                                <td> <div id="dispatchStatus{{m.orderdetail__id}}"
                                    class="dispatch-status">
                                    
                                    </div> 
                                </td>              
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                    <div class="pagidis">
                    <div></div>
                    <div class="card text-center" style="border: none;">
                            <div class="card-footer text-body-secondary" style="background-color: #fff; border: none;" >
                            Displaying all {{queryset_length}} assets
                            </div>
                    </div>
                    <div class="pagination">
                        <span class="step-links">
                            {% if assets.has_previous %}
                                <a href="?page=1">&laquo; first</a>
                                <a href="?page={{ assets.previous_page_number }}">previous</a>
                            {% endif %}
                    
                            <span class="current">
                                Page {{ assets.number }}1 of 1{{ assets.paginator.num_pages }}.
                            </span>
                    
                            {% if assets.has_next %}
                                <a href="?page={{ assets.next_page_number }}">next</a>
                                <a href="?page={{ assets.paginator.num_pages }}">last &raquo;</a>
                            {% endif %}
                        </span>
                    </div>
                </div>
                </section>
                
    
            </div>
           
           
          
        </div>
        
    
        </div>
    
    </section>
  </div>
  

  


</div>
  



<script>
    function openCity(evt, cityName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";

    }
</script>



<script>
        // Customize your Dropzone options as needed
        Dropzone.options.imageUpload = {
            paramName: "image", // The name that will be used to transfer the file
            maxFilesize: 2, // MB
            acceptedFiles: "image/*",
            addRemoveLinks: true, // Display remove link
            dictDefaultMessage: "<span style='font-size: 14px; color:#6A1B9A; ' > Upload </span>",
            dictRemoveFile: "Remove",
            init: function () {
                
            }
        };
        
</script>


<script>
    function changeTab(tabName){
        document.getElementById(tabName).style.display = "block";
    }
</script>



<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>
<script>
    {% if messages %}
        {% for msg in messages %}
            alertify.set('notifier','position', 'top-right');
            alertify.success('{{msg}}');
        {% endfor %}
    {% endif %}
</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
    function uploadFile(id) {
        var fileInput = document.getElementById('attachfile');
        var selectedFile = fileInput.files[0];
        console.log(fileInput,"---------------------------------")
        if (selectedFile) { 
            var formData = new FormData();
            formData.append('file', selectedFile);
            formData.append('id', id);
            
            $.ajax({
                type: "POST",
                url: "/asset_management/attach-file-to-customer/",
                data: formData,
                processData: false,
                contentType: false,
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                success: function(response) {
                    window.location.reload()
    
                },
                error: function(xhr, status, error) {
                    window.location.reload()
                }
            });
        }
    }
</script>



<script>
    function update_comment_again(id) {
        var comment = $('#commentText').val(); 
        $.ajax({
            type: "POST",
            url: "/asset_management/customer-comments/", 
            data: {
                'id': id,
                'comment': comment,
                'csrfmiddlewaretoken': '{{ csrf_token }}'  
            },
            success: function(response) {
                window.location.reload()

            },
            error: function(xhr, status, error) {
                console.error("Error updating comment:", error);
            }
        });
    }
</script>



<script>
    function delete_attached_file(id) {
    let spinner = ` <div id="spinner">
            <div class="d-flex justify-content-center">
                <div class="spinner-border" role="status">
                  <span class="visually-hidden"></span>
                </div>
              </div>
        </div> `
        $('#attachFile').html(spinner)
    $.ajax({
        type: "POST",
        url: "/asset_management/customer-attach-file-delete/",
        data: {
            'id': id,
            'csrfmiddlewaretoken': '{{ csrf_token }}'
        },
        success: function (response) {
            window.location.reload();
        },
        error: function (xhr, status, error) {
            console.error("Error updating comment:", error);
        }
    });
}
</script>



<script>
    function generate_order_pdf(id) {
            $.ajax({
            type: "GET",
            url: "/asset_management/order-detail-pdf/",
            data: { id: id },
            success: function(response) {
                var blob = new Blob([response], { type: 'application/pdf' });
                var url = window.URL.createObjectURL(blob);
                window.open(url);
            },
            error: function(xhr, status, error) {
                console.error(error);
                alert('Failed to generate PDF.');
            }
        });
    }
    </script>



    <script>
        function goToConfirmOrdersList(id){
            window.location.href = '/asset_management/confirmed-orders-list/'
            
        }
    </script>



 {% for m in customer_orders %}
    <script>
        var orderStatus = {{m.orderdetail__order_status}}
        var orderStatusElement = document.getElementById("orderStatus{{m.orderdetail__id}}");
        // Check the order orderStatus and set the text color accordingly
        if (orderStatus == 2) {
            orderStatusElement.style.backgroundColor  = "#28a745"; 
            orderStatusElement.style.color = "white";
            orderStatusElement.style.fontWeight = 700;
        } else if (orderStatus == 3) {
            orderStatusElement.style.backgroundColor  = "red";
            orderStatusElement.style.color = "white";
            orderStatusElement.style.fontWeight = 700;
        }
        else if (orderStatus == 4) {
            orderStatusElement.style.backgroundColor  = "#28a745";
            orderStatusElement.style.color = "white";
            orderStatusElement.style.fontWeight = 700;
        }
         else {
            orderStatusElement.style.backgroundColor  = "#ffc107"; 
            orderStatusElement.style.color = "white";
            orderStatusElement.style.fontWeight = 700;
 
        }
    </script>

{% endfor %} 



<script>
    function order_dispatch(order_id) {
    var dispatchStatusElement = document.getElementById("dispatchStatus" + order_id);
        $.ajax({
            type: "POST",
            url: "/asset_management/dispatch-order/", 
            data: {
                'order_id': order_id,
                'csrfmiddlewaretoken': '{{ csrf_token }}'  
            },
            success: function(response_data) {
                if (response_data.success) {
                    dispatchStatusElement.style.backgroundColor = "#001AFF";
                    dispatchStatusElement.style.color = "white"
                    dispatchStatusElement.style.fontWeight = 700;
                    dispatchStatusElement.innerText = "Dispatched";
                    alertify.set('notifier','position', 'top-right');
                    alertify.success('Asset Dispatched');

                }
            },
            error: function(xhr, status, error) {
                console.error("Error updating comment:", error);
            }
        });
    }
</script>


{% for m in customer_orders%}
<script>
    var dispatchStatusElement = document.getElementById("dispatchStatus{{m.orderdetail__id}}");
    var orderStatus = {{ m.orderdetail__order_status }};
    var orderDispatched = {% if m.orderdetail__order_dispatch %}true{% else %}false{% endif %};

    dispatchStatusElement.innerHTML = '';

    if (orderStatus == 2 && !orderDispatched) {

        var buttonElement = document.createElement("button");
        dispatchStatusElement.style.background = "#E5E8FF";
        buttonElement.style.border = "none";
        buttonElement.style.background = "none";
        buttonElement.style.fontWeight = 700;
        buttonElement.style.color = "#001AFF";
        buttonElement.innerText = "Ready to dispatch";
        buttonElement.onclick = function () {
            order_dispatch({{ m.orderdetail__id }});
        };
        dispatchStatusElement.appendChild(buttonElement);
    } else if (orderStatus == 4) {

        var spanElement = document.createElement("span");
        spanElement.innerText = "Dispatched";
        dispatchStatusElement.style.backgroundColor = "#001AFF"
        dispatchStatusElement.style.color = "white"
        dispatchStatusElement.style.fontWeight = 700;
        dispatchStatusElement.appendChild(spanElement);
    } else if (orderStatus == 3) {

        dispatchStatusElement.innerText = "Cancelled";
        dispatchStatusElement.style.backgroundColor  = "red";
        dispatchStatusElement.style.color = "white"
        dispatchStatusElement.style.fontWeight = 700;
    } else {

        dispatchStatusElement.innerText = "Order not approved";
        dispatchStatusElement.style.backgroundColor = "#ffc107 "; //yellow
        dispatchStatusElement.style.color = "white";
        dispatchStatusElement.style.fontWeight = 700;

    }

</script>
{% endfor %}


{% endblock content %}